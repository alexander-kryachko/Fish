$(document).ready(function(){$("tr:nth-child(odd)").addClass("odd");$(".image_container").live("mouseenter",function(){$('.links',this).show()}).live("mouseleave",function(){$('.links',this).hide()});$('.colorbox').colorbox({overlayClose:true,opacity:0.5})});function setMainImage(a,b){var c=$(a).closest('.image_container');var d=$('img',c);if(d.is('.main_image')){return}else{var e=c.closest('.product_images');var f=$('img.main_image',e);if(f){f.removeClass('main_image');old_image_container=f.closest('.image_container');$('input[name*=\'image\['+b+'\]\[main\]\']',old_image_container).val(0)}d.addClass('main_image');$('input[name*=\'image\['+b+'\]\[main\]\']',c).val(1)}}function deleteImage(a,b){var c=$(a).closest('.image_container');var d=$('img',c);if(d.is('.new')){c.remove()}else if($('input[name*=\'image\['+b+'\]\[deleted\]\']',c).val()==1){d.removeClass('deleted');$('input[name*=\'image\['+b+'\]\[deleted\]\']',c).val(0);$(a).addClass('link_delete');$(a).removeClass('link_exclude')}else{d.addClass('deleted');$('input[name*=\'image\['+b+'\]\[deleted\]\']',c).val(1);$(a).addClass('link_exclude');$(a).removeClass('link_delete')}}function addPaginationLinks(){var a=arguments[0];var b=arguments[1];var c=b.cursor;var d=c.currentPageIndex;var e=$('<div></div>').addClass('paginationContainer');for(var i=0;i<c.pages.length;i++){var f=c.pages[i];if(d==i){e.append('<b>'+f.label+'</b>')}else{$('<a></a>',{href:'javascript:imageSearch.gotoPage('+i+');',text:f.label}).css("margin","3px").appendTo(e)}}$('#content'+a).append(e)}function searchComplete(){var c=arguments[0];var d=arguments[1];if(d.results&&d.results.length>0){var e=$('#content'+c).empty();var f=$('<div></div>').addClass('contentContainer');var g=d.results;for(var i=0;i<g.length;i++){var h=g[i];var j=$('<div></div>').addClass('imgContainer');var k=$('<div></div>').addClass('title').text(h.titleNoFormatting).appendTo(j);var l=$('<div></div>').addClass('descr').text(h.width+"x"+h.height).appendTo(j);var m=$('<a></a>',{href:h.unescapedUrl,rel:'colorbox_s'+c,nid:c}).addClass('colorbox big-image-link');var n=$('<img>',{title:h.titleNoFormatting,src:h.tbUrl}).addClass('image').appendTo(m);m.appendTo(j);var o=$('<a></a>',{href:'#',onclick:'addImage(this, '+c+'); return false;'}).addClass('add-button').appendTo(j);j.appendTo(f)}e.append(f);addPaginationLinks(c,d);$('.colorbox').colorbox({overlayClose:true,opacity:0.5,title:function(){var a=$(this).attr('href');var b=$(this).attr('nid');return'<a href="#" class="add-button" onclick="addCboxImage(\''+a+'\', '+b+'); return false;"></a>'}})}}function addCboxImage(a,b){var c=$('.imgContainer a[href=\''+a+'\']','#content'+b).parent().find('a.add-button');addImage(c,b)}function addImage(a,b){var c=$('a.big-image-link',$(a).parent()).attr('href');var d=$('a.big-image-link',$(a).parent()).clone();d.attr('rel','colorbox_p'+b);d.find('img').addClass('new');var e=$('<input>',{type:'hidden',value:c,name:'image['+b+'][url][]'});var f=$('<input>',{type:'hidden',value:'0',name:'image['+b+'][deleted][]'});var g=$('<input>',{type:'hidden',value:'0',name:'image['+b+'][main][]'});var h=$('<div></div>').addClass('links');var i=$('<a></a>',{href:'#',onclick:'setMainImage(this, '+b+'); return false;'}).addClass('link_main');var j=$('<a></a>',{href:'#',onclick:'deleteImage(this, '+b+'); return false;'}).addClass('link_delete');h.append(i).append(j);$('<div></div>').addClass('image_container').append(d).append(e).append(f).append(g).append(h).appendTo('#product_images'+b);$('.colorbox').colorbox({overlayClose:true,opacity:0.5})}
